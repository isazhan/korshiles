<form method="post" action="{% url 'create_ad' %}">
    {% csrf_token %}
    <label for="category">Select Category:</label>
    <select id="category" onchange="loadSubcategories()" name="city">
        <option value="">Select</option>
    </select>
    
    <label for="subcategory">Select Subcategory:</label>
    <select id="subcategory" name="district">
        <option value="">Select</option>
    </select>
    <button type="submit">Отправить</button>
</form>


<script>
  // Function to load options from JSON file
  function loadOptions(callback) {
      // You can replace 'options.json' with the path to your JSON file
      fetch('../../static/base/cities.json')
          .then(response => response.json())
          .then(data => callback(data))
          .catch(error => console.error('Error loading options:', error));
  }

  // Function to populate the category select
  function loadCategories() {
      var categorySelect = document.getElementById('category');
      loadOptions(function (data) {
          data.categories.forEach(function (category) {
              var option = document.createElement('option');
              option.value = category.id;
              option.textContent = category.name;
              categorySelect.appendChild(option);
          });
      });
  }

  // Function to populate the subcategory select based on the selected category
  function loadSubcategories() {
      var categorySelect = document.getElementById('category');
      var subcategorySelect = document.getElementById('subcategory');
      
      // Clear subcategory options
      subcategorySelect.innerHTML = '<option value="">Select</option>';
      
      // Get selected category value
      var selectedCategory = categorySelect.value;
      
      if (selectedCategory !== "") {
          loadOptions(function (data) {
              var selectedCategoryData = data.categories.find(function (category) {
                  return category.id === selectedCategory;
              });

              selectedCategoryData.subcategories.forEach(function (subcategory) {
                  var option = document.createElement('option');
                  option.value = subcategory.id;
                  option.textContent = subcategory.name;
                  subcategorySelect.appendChild(option);
              });
          });
      }
  }

  // Initialize the category select on page load
  window.onload = loadCategories;
</script>